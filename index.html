<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Realistic Island Temple</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87ceeb; touch-action: none; }
        #joystick { position: absolute; bottom: 30px; left: 30px; width: 100px; height: 100px; background: rgba(255,255,255,0.2); border-radius: 50%; display: none; }
        #knob { position: absolute; width: 40px; height: 40px; background: #fff; border-radius: 50%; top: 30px; left: 30px; }
    </style>
</head>
<body>
    <div id="joystick"><div id="knob"></div></div>
    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { Sky } from 'three/addons/objects/Sky.js';

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 5000);
        camera.position.set(250, 60, 250);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);

        // --- ОСВІТЛЕННЯ (Виправляємо темряву) ---
        const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 1.2); // Світло від неба
        scene.add(hemiLight);

        const sunLight = new THREE.DirectionalLight(0xfff5e1, 2.5);
        sunLight.position.set(200, 300, 100);
        sunLight.castShadow = true;
        scene.add(sunLight);

        // --- НЕБО ---
        const sky = new Sky(); sky.scale.setScalar(45000); scene.add(sky);
        const sun = new THREE.Vector3();
        sun.setFromSphericalCoords(1, THREE.MathUtils.degToRad(85), THREE.MathUtils.degToRad(170));
        sky.material.uniforms['sunPosition'].value.copy(sun);

        // --- ОСТРІВ ---
        const terrainGeo = new THREE.CylinderGeometry(400, 420, 20, 64);
        const terrainMat = new THREE.MeshStandardMaterial({ color: 0x99aa55, roughness: 1 });
        const island = new THREE.Mesh(terrainGeo, terrainMat);
        island.position.y = -10;
        island.receiveShadow = true;
        scene.add(island);

        // --- ХРАМ "ТОЧ-В-ТОЧ" ---
        const temple = new THREE.Group();
        const size = 100;
        const stripeH = 8;
        
        // Стіни зі смугами (як на фото 1000018189.jpg)
        for(let i=0; i<10; i++) {
            const mat = new THREE.MeshStandardMaterial({ color: i % 2 === 0 ? 0x0044cc : 0xffffff });
            const box = new THREE.Mesh(new THREE.BoxGeometry(size, stripeH, size), mat);
            box.position.y = i * stripeH + stripeH/2;
            box.castShadow = true;
            temple.add(box);
        }

        // Золотий купол (як на фото 1000018188.jpg)
        const dome = new THREE.Mesh(
            new THREE.SphereGeometry(size/2, 32, 32, 0, Math.PI*2, 0, Math.PI/2),
            new THREE.MeshStandardMaterial({ color: 0xffaa00, metalness: 1, roughness: 0.1 })
        );
        dome.position.y = 80;
        temple.add(dome);
        
        // Арка (синій вхід)
        const arch = new THREE.Mesh(new THREE.TorusGeometry(20, 3, 16, 100, Math.PI), new THREE.MeshStandardMaterial({color: 0x0044cc}));
        arch.position.set(0, 40, size/2 + 1);
        temple.add(arch);

        scene.add(temple);

        // --- ЛАБІРИНТ (Червона підлога) ---
        const mazeGeo = new THREE.PlaneGeometry(250, 250);
        const mazeMat = new THREE.MeshStandardMaterial({ color: 0xaa0000, roughness: 0.8 });
        const maze = new THREE.Mesh(mazeGeo, mazeMat);
        maze.rotation.x = -Math.PI/2;
        maze.position.set(0, 0.5, 150);
        scene.add(maze);

        // --- ПАЛЬМИ (Рухливе листя) ---
        const palmMat = new THREE.MeshStandardMaterial({ color: 0x225511 });
        function createPalm(x, z) {
            const p = new THREE.Group();
            const trunk = new THREE.Mesh(new THREE.CylinderGeometry(1, 2, 60), new THREE.MeshStandardMaterial({color: 0x443322}));
            trunk.position.y = 30;
            p.add(trunk);
            
            for(let i=0; i<8; i++) {
                const leaf = new THREE.Mesh(new THREE.BoxGeometry(25, 1, 5), palmMat);
                leaf.position.y = 60;
                leaf.rotation.y = (i / 8) * Math.PI * 2;
                leaf.rotation.z = 0.5;
                leaf.name = "leaf";
                p.add(leaf);
            }
            p.position.set(x, 0, z);
            scene.add(p);
        }
        for(let i=0; i<20; i++) {
            createPalm(Math.cos(i)*250, Math.sin(i)*250);
        }

        // --- АНІМАЦІЯ ---
        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.002;
            scene.traverse((obj) => {
                if(obj.name === "leaf") {
                    obj.rotation.z = 0.5 + Math.sin(time + obj.rotation.y) * 0.1; // Вітер
                }
            });
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
